
def stworz_wykres(hmax, x, y):
    wykres, os = plt.subplots()
    dane = []

    os.set_xlabel('x')
    os.set_ylabel('y')
    os.set_title('Wykres zmiany położenia piłki')
    line, = os.plot(x, y, '-m', linewidth=3)        # ślad
    lineb, = os.plot(x, y, 'ob', markersize=10)     # piłka
    os.set_xlim(-1, 4 * hmax)
    os.set_ylim(0, 2 * hmax)
    dane.append((line, lineb))

    plt.show()

    return wykres, os, dane


def aktualizuj_wykres(os,dane,t,x,y):
    line,lineb = dane[0]
    lineb.set_xdata(x)
    lineb.set_ydata(y)
    line.set_xdata( np.append(line.get_xdata(), x))
    line.set_ydata( np.append(line.get_ydata(), y))
    os.set_title('t = %.2f' % t)
    if x > os.get_xlim()[1]:
        os.set_xlim(-1,2*x)
    if y > os.get_ylim()[1]:
        os.set_ylim(0,2*y)

    plt.show()
    return


    #wykres, os, dane = stworz_wykres(pilka.hmax, pilka.x, pilka.y)
    #aktualizuj_wykres(os, dane, t, pilka.x, pilka.y)

"""
    fig, ax = plt.subplots()
    ax.set_xlim(0, tmax*1.1)
    ax.set_ylim(0, pilka.hmax*2)
    line, = ax.plot(0, 0)


    animacja = FuncAnimation(fig, func=klatka_animacji, interval=30)
    plt.show()
    animacja.save('hophop01.gif', writer='imagemagick', fps=50)
    """


def aktualizuj_pilke_stare(x_stare, y_stare, vx_stare, vy_stare, t, dt):
    # uaktualnienie położenia x i y oraz prędkości vy - niech vx będzie na razie stałe
    vx_nowe = vx_stare #+ g * dt
    vy_nowe = vy_stare + g * dt
    x_nowe = x_stare + vx_stare * dt
    y_nowe = y_stare + vy_stare * dt

    # sprawdzanie czy piłka nie no-clip'uje przez podłogę
    # jeśli tak, to robimy krok czasowy trochę mniejszsy, żeby akurat trafić w położenie y=0
    if y_nowe < 0:
        y_nowe = 0
        dt_hop = -y_stare / vy_stare  # liczenie czasu dt, po którym nastąpi odbicie od podłogi
        vy_nowe = -(vy_stare + g * dt_hop)
        x_nowe = x_stare + vx_stare * dt_hop
        t += dt_hop
    else:
        t += dt

    return x_nowe, y_nowe, vx_nowe, vy_nowe, t
